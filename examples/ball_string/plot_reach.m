% Plot reachable region (Code generated by Hylaa using PLOT_MATLAB)
h = figure(1);
set(h, 'Position', [200 200 800 600]);
hold on;

% data
reachSet = [
    {'extension', [0.666666666667 1.0 0.666666666667], [0.0 1.0 0.0], 0, {
    [-1.05, 0.0;-1.05, -0.15;-0.95, -0.15;-0.95, 0.15;-1.05, 0.15;-1.05, 0.0;]
    [-1.03438503298, 1.68183452934;-0.936326300432, 1.49090409424;-0.93059838659, 1.76216863164;-1.02865711914, 1.95309906674;-1.03438503298, 1.68183452934;]
    [-0.98409789746, 3.30839333557;-0.891588190306, 2.94852718162;-0.880792205119, 3.18287235189;-0.973301912273, 3.54273850584;-0.98409789746, 3.30839333557;]
    [-0.903731001423, 4.68313905001;-0.819888096275, 4.18111343069;-0.804827327815, 4.37239907025;-0.888670232963, 4.87442468957;-0.903731001423, 4.68313905001;]
    [-0.798676179061, 5.77276002417;-0.726046085763, 5.15873923367;-0.707625462101, 5.30294701638;-0.780255555399, 5.91696780689;-0.798676179061, 5.77276002417;]
    [-0.674856571926, 6.5574302054;-0.615359948605, 5.86355035479;-0.594543553451, 5.95877464407;-0.654040176772, 6.65265449468;-0.674856571926, 6.5574302054;]
    [-0.538458897069, 7.0305315435;-0.493365540126, 6.28951771559;-0.471135124724, 6.33587612492;-0.516228481667, 7.07688995283;-0.538458897069, 7.0305315435;]
    [-0.395676096191, 7.19789225869;-0.365606332473, 6.44175938967;-0.342922345903, 6.4412327323;-0.372992109621, 7.19736560132;-0.395676096191, 7.19789225869;]
    [-0.252469682586, 7.07660657067;-0.237420530944, 6.33548744606;-0.215186957515, 6.29170060569;-0.230236109157, 7.0328197303;-0.252469682586, 7.07660657067;]
    [-0.114358997675, 6.69351355512;-0.113752209668, 5.99464900421;-0.0927862735928, 5.91260562173;-0.0933930616005, 6.61147017264;-0.114358997675, 6.69351355512;]
    }}
    {'freefall', [0.666666666667 1.0 1.0], [0.0 1.0 1.0], 0, {
    [0.00100772700097, 5.45033729043;0.0200002002574, 5.33612206983;0.0327486418686, 5.96920452866;0.0137561686122, 6.08341974926;0.00100772700097, 5.45033729043;]
    [0.108052472753, 5.25413729043;0.124760641598, 5.13992206983;0.150170732385, 5.77300452866;0.133462563541, 5.88721974926;0.108052472753, 5.25413729043;]
    [0.211173218562, 5.05793729043;0.225597082994, 4.94372206983;0.263668822959, 5.57680452866;0.249244958526, 5.69101974926;0.211173218562, 5.05793729043;]
    [0.310369964313, 4.86173729043;0.322509524333, 4.74752206983;0.373242913474, 5.38060452866;0.361103353454, 5.49481974926;0.310369964313, 4.86173729043;]
    [0.405642710122, 4.66553729043;0.41549796573, 4.55132206983;0.478893004047, 5.18440452866;0.46903774844, 5.29861974926;0.405642710122, 4.66553729043;]
    [0.496991455931, 4.46933729043;0.504562407126, 4.35512206983;0.580619094621, 4.98820452866;0.573048143425, 5.10241974926;0.496991455931, 4.46933729043;]
    [0.584416201739, 4.27313729043;0.589702848523, 4.15892206983;0.678421185194, 4.79200452866;0.67313453841, 4.90621974926;0.584416201739, 4.27313729043;]
    [0.66791694749, 4.07693729043;0.670919289861, 3.96272206983;0.772299275709, 4.59580452866;0.769296933338, 4.71001974926;0.66791694749, 4.07693729043;]
    [0.747493693299, 3.88073729043;0.748211731258, 3.76652206983;0.862253366282, 4.39960452866;0.861535328323, 4.51381974926;0.747493693299, 3.88073729043;]
    [0.821580172654, 3.57032206983;0.948283456855, 4.20340452866;0.949849723308, 4.31761974926;0.823146439108, 3.68453729043;0.821580172654, 3.57032206983;]
    [0.891024614051, 3.37412206983;1.0, 3.8691562482;1.0, 3.96587977407;0.894875184916, 3.48833729043;0.891024614051, 3.37412206983;]
    [0.956545055447, 3.17792206983;1.0, 3.3588809698;1.0, 3.4475488035;0.962679930725, 3.29213729043;0.956545055447, 3.17792206983;]
    }}
];

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', edge_color);

        reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

deepest_simulation=[-0.9911230442139819,0.14999999999999988;
-0.9709231221902309,1.8406850528306626;
-0.9188350107493641,3.330860280714744;
-0.8393060904136981,4.5788472997494605;
-0.7374931677748693,5.555451130940826;
-0.6190103663815422,6.24411925480238;
-0.48967886232923497,6.640603677195954;
-0.35528793414662097,6.752177694846178;
-0.22137560581803808,6.596471431632197;
-0.09303577901419352,6.200000079297863;
0.02524278534433319,5.596464834672435;
0.13521008197999826,5.400264834672435;
0.24125337867344696,5.204064834672435;
0.34337267536689564,5.007864834672435;
0.44156797206034426,4.811664834672435;
0.535839268753793,4.615464834672435;
0.6261865654472417,4.419264834672435;
0.7126098621406903,4.223064834672435;
0.795109158834139,4.026864834672436;
0.8736844555275877,3.8306648346724357;
0.9483357522210365,3.634464834672435;
]

longest_simulation=[-1.05,-0.15;
-1.034385031770868,1.6818345364232867;
-0.9840978948745941,3.3083933238451113;
-0.903731011771964,4.683139061881188;
-0.7986761831567848,5.772760111564922;
-0.6748565662310334,6.557430327838086;
-0.5384588757506347,7.030531685715564;
-0.39567608422888423,7.197892395573395;
-0.2524696635499196,7.076606685348476;
-0.11435897454118213,6.693513665262568;
0.013756206371055589,6.083419768670037;
0.1334626016868143,5.887219768670037;
0.24924499706021502,5.691019768670037;
0.3611033924336158,5.494819768670037;
0.4690377878070163,5.2986197686700365;
0.5730481831804171,5.102419768670037;
0.6731345785538178,4.906219768670037;
0.7692969739272186,4.710019768670037;
0.8615353693006192,4.513819768670037;
0.9498497646740199,4.317619768670037;
1.0342401600474207,4.1214197686700365;
]

robust_simulation=[-1.0264154143666877,0.0;
-1.0083943294049196,1.7724366587568101;
-0.9568818713319965,3.340692976337594;
-0.8764266250861127,4.66038122263599;
-0.7723363639053387,5.7000497434438175;
-0.6504163357091504,6.441393780635211;
-0.5167085866916004,6.878945846512842;
-0.3772422617613039,7.019298264912214;
-0.23780359625782316,6.879923386616968;
-0.10373289866570937,6.487667679895723;
0.020245776140878857,5.877002288699545;
0.13582382185716338,5.680802288699545;
0.24747786763115429,5.484602288699545;
0.3552079134051452,5.288402288699546;
0.4590139591791361,5.092202288699545;
0.558896004953127,4.896002288699545;
0.6548540507271179,4.699802288699545;
0.7468880965011089,4.503602288699545;
0.8349981422750997,4.307402288699545;
0.9191841880490905,4.111202288699545;
0.9994462338230816,3.915002288699545;
]

usafe_rectangle = [-0.5,5.0;0.5,5.0;0.5,6.2;-0.5,6.2;-0.5,5.0;]

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', edge_color);

        %reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

colorspec = {[0.9 0.9 0.9]; [0.8 0.8 0.8]; [0.6 0.6 0.6]; [0.5 0.3 0.9]; [0.5 0.5 0.5]; [0.4 0.4 0.4]; [0.2 0.2 0.2]};
usafe = plot(usafe_rectangle(:,1), usafe_rectangle(:,2), 'LineWidth', 2, 'LineStyle', '-.', 'Color', colorspec{4}, 'DisplayName', 'Unsafe set = [(-2.0, 2.0), (4.0,6.0)]');
p1 = plot(deepest_simulation(:,1), deepest_simulation(:,2), 'Color','red', 'DisplayName', 'Deepest in Y direction = [-6.0, 1.0]');
p2 = plot(longest_simulation(:,1), longest_simulation(:,2), 'Color','blue', 'DisplayName', 'Longest counter-example = [-5.373,0.0]');
p3 = plot(robust_simulation(:,1), robust_simulation(:,2), 'Color', 'm', 'DisplayName', 'Robust counter-example = [-5.870, 0.0]');
p1.Marker = '*';
p2.Marker = 'o';
p3.Marker = 'x';
legend([usafe,p1,p2,p3]);
%p1.legend = 'first deepest';
%legend('first deepest', 'second deepest', 'hylaa');
% optional legend
%if (size(reachSet,1) > 1 && size(reachSet,1) < 10)
%    legend([reachSet{:,3}], reachSet{:,1})
%	end

% labels and such
xlabel('X', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
ylabel('Y', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
title('Ball-String benchmark', 'FontSize', 32, 'FontName', 'Serif', 'Interpreter','LaTex');
hold off;
